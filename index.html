<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Garden Party Planner</title>
<style>
body { margin:0; font-family:'Segoe UI',sans-serif; background:#f4f7f2; color:#2f3e2f;}
header { text-align:center; padding:40px 20px; background:linear-gradient(to right,#cde5cd,#eaf4ea);}
header h1{margin:0; font-size:2.2rem;}
header p{margin-top:10px; font-size:1.1rem; opacity:0.8;}
.container{max-width:1000px;margin:30px auto;padding:20px;}
.section{padding:25px;margin-bottom:25px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.05);}
.section:nth-child(odd){background-color:#eaf4ea;}
.section:nth-child(even){background-color:#d1e7d1;}
.section h2,.section h3{margin-top:0;color:#3b5d3b;}
.task-item{display:flex;align-items:center;margin-bottom:10px;}
.task-item input[type="checkbox"]{margin-right:10px;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table th,table td{border:1px solid #ddd;padding:8px;}
table th{background-color:#cde5cd;text-align:left;}
input[type="text"], input[type="number"], textarea{width:90%;padding:6px;border-radius:4px;border:1px solid #ccc;margin-top:5px;}
button{padding:8px 16px;margin-top:8px;background-color:#3b5d3b;color:white;border:none;border-radius:6px;cursor:pointer;transition:0.3s;}
button:hover{background-color:#2f4b2f;}
.total-cost{margin-top:10px;font-weight:bold;font-size:1rem;}
#overall-summary{background-color:#cde5cd;padding:15px;border-radius:10px;font-weight:bold;margin-bottom:25px;text-align:center;}
.list-container{margin-top:15px;}
.list-container ul{padding-left:20px;}
.list-container li{margin-bottom:5px;}
.collapsible{background-color:#8fcf8f;color:white;cursor:pointer;padding:10px;width:100%;text-align:left;border:none;outline:none;font-size:1rem;border-radius:5px;margin-top:15px;}
.active,.collapsible:hover{background-color:#6bb36b;}
.content{padding:0 10px;display:none;overflow:hidden;background-color:#f4f7f2;margin-top:5px;border-radius:5px;border:1px solid #cde5cd;}
#export-btn{margin-bottom:20px;background-color:#6b8f6b;}
#export-btn:hover{background-color:#4b704b;}
.menu-tab{background:#8fcf8f;color:white;padding:10px;cursor:pointer;border-radius:6px;margin-bottom:10px;border:none;width:100%;text-align:left;font-size:1.1rem;}
.menu-tab.active,.menu-tab:hover{background:#6bb36b;}
.menu-content{display:none;padding:15px;background:#f4f7f2;border-radius:8px;border:1px solid #cde5cd;margin-bottom:20px;}
.menu-section{margin-bottom:15px;}
.menu-section h3{margin:5px 0;color:#3b5d3b;}
.menu-section ul{padding-left:20px;margin-top:5px;}
.menu-section li{margin-bottom:5px;}
.menu-section input{width:70%;padding:5px;border-radius:4px;border:1px solid #ccc;margin-right:5px;}
.menu-section button{padding:5px 10px;background:#3b5d3b;color:white;border:none;border-radius:4px;cursor:pointer;}
.menu-section button:hover{background:#2f4b2f;}
</style>
</head>
<body>
<header>
<h1>Interactive Garden Party Planner</h1>
<p>Tasks, Budget, Have/Need Lists, Full Menu Management, Auto-save, PDF Export</p>
</header>

<div class="container">
<button id="export-btn">Export Planner as PDF</button>
<div id="overall-summary">Total Cost Across All Timelines: $0</div>

<!-- Menu Tab -->
<button class="menu-tab">Menu Management</button>
<div class="menu-content">
  <div class="menu-section" data-category="welcomeDrinks">
      <h3>Welcome Drinks</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add welcome drink">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="appetizers">
      <h3>Appetizers / Starters</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add appetizer">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="salads">
      <h3>Salads & Light Bites</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add salad/light bite">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="mainOptions">
      <h3>Main Options</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add main option">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="desserts">
      <h3>Desserts</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add dessert">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="extras">
      <h3>Extras / Grazing Table</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add extra item">
      <button>Add</button>
  </div>
  <div class="menu-section" data-category="kidsMenu">
      <h3>Kids Menu</h3>
      <ul class="item-list"></ul>
      <input type="text" placeholder="Add kids menu item">
      <button>Add</button>
  </div>
</div>

<!-- Timeline Planner -->
<div id="planner-container"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
// ===== Timeline Tasks =====
const tasksData = {
"1–2 Weeks Before: Planning & Foundations":["Decide purpose & vibe","Set date/time/guest count","Choose theme/color palette","Create rough budget","Plan menu","Check weather/backup plan","Make guest list & send invites","List what you have vs need"],
"5–7 Days Before: Prep Mode":["Finalize menu & drinks","Shop non-perishables","Drinks & ice plan","Disposable items","Arrange rentals","Plan seating","Test lighting","Prepare playlist","Tidy garden"]
};

const container = document.getElementById("planner-container");
const overallSummaryEl = document.getElementById("overall-summary");
let savedData = JSON.parse(localStorage.getItem("gardenPlannerData"))||{};

// ===== Render Timeline Sections =====
for(let section in tasksData){
  const sectionDiv = document.createElement("div");
  sectionDiv.className="section";
  const h2=document.createElement("h2");
  h2.textContent=section;
  sectionDiv.appendChild(h2);

  // Tasks
  tasksData[section].forEach((task,idx)=>{
    const taskDiv=document.createElement("div");
    taskDiv.className="task-item";
    const checkbox=document.createElement("input");
    checkbox.type="checkbox";
    if(savedData[section]?.tasks?.[idx]) checkbox.checked=true;
    checkbox.onchange=saveTasks;
    const span=document.createElement("span");
    span.textContent=task;
    taskDiv.appendChild(checkbox); taskDiv.appendChild(span);
    sectionDiv.appendChild(taskDiv);
  });

  // Budget Table
  const budgetTable=document.createElement("table");
  budgetTable.innerHTML=`<thead><tr><th>Item</th><th>Cost ($)</th><th>Action</th></tr></thead><tbody></tbody>`;
  sectionDiv.appendChild(budgetTable);
  const tbody=budgetTable.querySelector("tbody");
  const budgetInputDiv=document.createElement("div");
  budgetInputDiv.style.marginTop="10px";
  budgetInputDiv.innerHTML=`<input type="text" placeholder="Item name" class="budget-item-name">
    <input type="number" placeholder="Estimated cost" class="budget-item-cost">
    <button>Add Item</button>
    <div class="total-cost">Total: $0</div>`;
  sectionDiv.appendChild(budgetInputDiv);
  const addBudgetBtn=budgetInputDiv.querySelector("button");
  const itemNameInput=budgetInputDiv.querySelector(".budget-item-name");
  const itemCostInput=budgetInputDiv.querySelector(".budget-item-cost");
  const totalCostEl=budgetInputDiv.querySelector(".total-cost");
  let sectionTotal=0;
  if(savedData[section]?.budget){
    savedData[section].budget.forEach(b=>{
      const row=createBudgetRow(b.name,b.cost,tbody,totalCostEl);
      tbody.appendChild(row); sectionTotal+=b.cost;
    });
    totalCostEl.textContent=`Total: $${sectionTotal.toFixed(2)}`;
  }
  addBudgetBtn.onclick=()=>{
    const name=itemNameInput.value.trim();
    const cost=parseFloat(itemCostInput.value);
    if(!name || isNaN(cost)) return;
    const row=createBudgetRow(name,cost,tbody,totalCostEl);
    tbody.appendChild(row); sectionTotal+=cost;
    totalCostEl.textContent=`Total: $${sectionTotal.toFixed(2)}`;
    itemNameInput.value=""; itemCostInput.value=""; saveTasks();
  };

  // Have/Need lists
  const listsContainer=document.createElement("div");
  listsContainer.className="list-container";
  listsContainer.innerHTML=`<h3>Things You Have</h3><ul class="have-list"></ul>
    <input type="text" placeholder="Add item" class="have-input"><button class="have-add">Add</button>
    <h3>Things to Buy / Rent</h3><ul class="need-list"></ul>
    <input type="text" placeholder="Add item" class="need-input"><button class="need-add">Add</button>`;
  sectionDiv.appendChild(listsContainer);
  const haveListEl=listsContainer.querySelector(".have-list");
  const needListEl=listsContainer.querySelector(".need-list");
  const haveInput=listsContainer.querySelector(".have-input");
  const needInput=listsContainer.querySelector(".need-input");
  listsContainer.querySelector(".have-add").onclick=()=>{if(haveInput.value.trim()){const li=document.createElement("li");li.textContent=haveInput.value;haveListEl.appendChild(li);haveInput.value="";saveTasks();}};
  listsContainer.querySelector(".need-add").onclick=()=>{if(needInput.value.trim()){const li=document.createElement("li");li.textContent=needInput.value;needListEl.appendChild(li);needInput.value="";saveTasks();}};

  container.appendChild(sectionDiv);
}

// ===== Budget Row =====
function createBudgetRow(name,cost,tbody,totalCostEl){
  const row=document.createElement("tr");
  row.innerHTML=`<td>${name}</td><td>${cost.toFixed(2)}</td><td><button style="background-color:#c94b4b;">Delete</button></td>`;
  row.querySelector("button").onclick=()=>{tbody.removeChild(row);saveTasks();};
  return row;
}

// ===== Save Data =====
function saveTasks(){
  const sections=container.querySelectorAll(".section");
  const data={};
  sections.forEach(sec=>{
    const title=sec.querySelector("h2").textContent;
    const tasks=Array.from(sec.querySelectorAll(".task-item input[type='checkbox']")).map(cb=>cb.checked);
    const budgetRows=Array.from(sec.querySelectorAll("tbody tr")).map(r=>({name:r.children[0].textContent,cost:parseFloat(r.children[1].textContent)}));
    const have=Array.from(sec.querySelectorAll(".have-list li")).map(li=>li.textContent);
    const need=Array.from(sec.querySelectorAll(".need-list li")).map(li=>li.textContent);
    data[title]={tasks,budget:budgetRows,have,need};
  });
  localStorage.setItem("gardenPlannerData",JSON.stringify(data));
  updateOverallSummary();
}

// ===== Overall Cost =====
function updateOverallSummary(){
  const data=JSON.parse(localStorage.getItem("gardenPlannerData"))||{};
  let total=0;
  for(let section in data){ if(data[section].budget) total+=data[section].budget.reduce((sum,b)=>sum+b.cost,0);}
  overallSummaryEl.textContent=`Total Cost Across All Timelines: $${total.toFixed(2)}`;
}
updateOverallSummary();

// ===== Export PDF =====
document.getElementById("export-btn").onclick=async()=>{
  const { jsPDF }=window.jspdf;
  const doc=new jsPDF('p','pt','a4');
  const containerEl=document.querySelector(".container");
  await html2canvas(containerEl,{scale:2}).then(canvas=>{
    const imgData=canvas.toDataURL("image/png");
    const imgWidth=595;
    const imgHeight=canvas.height*imgWidth/canvas.width;
    doc.addImage(imgData,'PNG',0,0,imgWidth,imgHeight);
  });
  doc.save("GardenPartyPlanner.pdf");
};

// ===== Menu Tab Logic =====
const menuTab=document.querySelector(".menu-tab");
const menuContent=document.querySelector(".menu-content");
const menuCategories=["welcomeDrinks","appetizers","salads","mainOptions","desserts","extras","kidsMenu"];
let menuData=JSON.parse(localStorage.getItem("gardenMenuData"))||{};
menuTab.addEventListener("click",()=>{
  menuContent.style.display=menuContent.style.display==="block"?"none":"block";
  menuTab.classList.toggle("active");
});
menuCategories.forEach(cat=>{
  const section=document.querySelector(`.menu-section[data-category="${cat}"]`);
  const ul=section.querySelector(".item-list");
  const input=section.querySelector("input");
  const btn=section.querySelector("button");
  if(menuData[cat]) menuData[cat].forEach(item=>{ const li=document.createElement("li"); li.textContent=item; ul.appendChild(li);});
  btn.onclick=()=>{if(input.value.trim()){ const li=document.createElement("li"); li.textContent=input.value; ul.appendChild(li); input.value=""; saveMenu();}};
});
function saveMenu(){
  menuCategories.forEach(cat=>{
    const section=document.querySelector(`.menu-section[data-category="${cat}"]`);
    const items=Array.from(section.querySelectorAll("ul.item-list li")).map(li=>li.textContent);
    menuData[cat]=items;
  });
  localStorage.setItem("gardenMenuData",JSON.stringify(menuData));
}
</script>
</body>
</html>
